<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Business Card</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        canvas {
            z-index: 1;
        }

        #arButton {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            z-index: 2;
        }
    </style>
</head>

<body>
<button id="arButton" onclick="onButtonClicked()">Enter AR</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
    //const BUTTON_MAP = {
        //'GitHub': 'https://github.com/ConnerC0',
        //'LinkedIn': 'https://www.linkedin.com/in/conner-curtis/'
   // };

    //const INFO_MAP = {
       // 'Resume': 'path-to-your-resume-image.jpg',
        //'Contact': 'path-to-your-contact-image.jpg'
    //};

    async function onButtonClicked() {
        if (!navigator.xr) {
            alert("WebXR not available.");
            return;
        }

        const { state } = await navigator.permissions.query({ name: 'xr' });
        if (state === 'denied') {
            alert('XR permissions denied.');
            return;
        }

        const canvas = document.createElement("canvas");
        document.body.appendChild(canvas);
        const gl = canvas.getContext("webgl", { xrCompatible: true });

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera();
        camera.matrixAutoUpdate = false;

        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.3);
        scene.add(directionalLight);

        const renderer = new THREE.WebGLRenderer({ alpha: true, canvas: canvas, context: gl });
        renderer.autoClear = false;

        const session = await navigator.xr.requestSession('immersive-ar');
        session.updateRenderState({
            baseLayer: new XRWebGLLayer(session, gl)
        });

        const referenceSpace = await session.requestReferenceSpace('local');

        //let infoPlane;



        function render(time, xrFrame) {
            const pose = xrFrame.getViewerPose(referenceSpace);
            if (pose) {
                const view = pose.views[0];
                camera.matrix.fromArray(view.transform.matrix);
                camera.updateMatrixWorld(true);
                renderer.render(scene, camera);
            }
            session.requestAnimationFrame(render);
        }

        session.requestAnimationFrame(render);
    }
</script>
</body>
</html>
